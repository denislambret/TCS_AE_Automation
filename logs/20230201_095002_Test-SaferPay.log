**********************
PowerShell transcript start
Start time: 20230201095002
Username: TCSGROUP\LD06974
RunAs User: TCSGROUP\LD06974
Configuration Name: 
Machine: Y0001194 (Microsoft Windows NT 10.0.19045.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\LD06974\.vscode\extensions\ms-vscode.powershell-2023.1.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2023.1.0' -AdditionalModules @('PowerShellEditorServices.VSCode') -BundledModulesPath 'c:\Users\LD06974\.vscode\extensions\ms-vscode.powershell-2023.1.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2023.1.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Normal' -LogPath 'c:\Users\LD06974\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\logs\1674651179-96a0fb54-87a7-4fc9-bf10-4be539e7a3e21674651173002\EditorServices.log' -SessionDetailsPath 'c:\Users\LD06974\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-4024-512267.json' -FeatureFlags @() 
Process ID: 21672
PSVersion: 7.3.0
PSEdition: Core
GitCommitId: 7.3.0
OS: Microsoft Windows 10.0.19045
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.10032.0, 6.0.0, 6.1.0, 6.2.0, 7.0.0, 7.1.0, 7.2.0, 7.3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
[20230201 09:50:02][Test-SaferPay.ps1][TCSGROUP\LD06974][INFO] ------------------------------------------------------------------------------------------------------------------------------------
[20230201 09:50:03][Test-SaferPay.ps1][TCSGROUP\LD06974][INFO] Test-SaferPay.ps1 v1.0
[20230201 09:50:03][Test-SaferPay.ps1][TCSGROUP\LD06974][INFO] ------------------------------------------------------------------------------------------------------------------------------------
[20230201 09:50:03][Test-SaferPay.ps1][TCSGROUP\LD06974][INFO] Connect to SFTP server sftp.tcs.ch
[20230201 09:50:03][Test-SaferPay.ps1][TCSGROUP\LD06974][INFO] Connection ID associated #24
[20230201 09:50:03][Test-SaferPay.ps1][TCSGROUP\LD06974][INFO] Check file(s) from /advancePay/In/
[20230201 09:50:03][Test-SaferPay.ps1][TCSGROUP\LD06974][INFO] No file found.... Check is OK.
[20230201 09:50:04][Test-SaferPay.ps1][TCSGROUP\LD06974][INFO] Check file(s) from /advancePay/Failed/
[20230201 09:50:04][Test-SaferPay.ps1][TCSGROUP\LD06974][WARNING] -> 6 file(s) found in /advancePay/Failed/
[20230201 09:50:04][Test-SaferPay.ps1][TCSGROUP\LD06974][WARNING] File : TCS_avancepay_20230127_061957.csv
[20230201 09:50:04][Test-SaferPay.ps1][TCSGROUP\LD06974][WARNING] File : TCS_avancepay_20221214_061710.csv
[20230201 09:50:04][Test-SaferPay.ps1][TCSGROUP\LD06974][WARNING] File : TCS_avancepay_20221128_062013.csv
[20230201 09:50:04][Test-SaferPay.ps1][TCSGROUP\LD06974][WARNING] File : TCS_avancepay_20230112_061741.csv
[20230201 09:50:04][Test-SaferPay.ps1][TCSGROUP\LD06974][WARNING] File : TCS_avancepay_20230124_061540.csv
[20230201 09:50:04][Test-SaferPay.ps1][TCSGROUP\LD06974][WARNING] File : TCS_avancepay_20230113_061805.csv
[20230201 09:50:04][Test-SaferPay.ps1][TCSGROUP\LD06974][WARNING] There should be no file here at control time ! Please check directory...
[20230201 09:50:04][Test-SaferPay.ps1][TCSGROUP\LD06974][INFO] Get file(s) from /advancePay/Success/
[20230201 09:50:04][Test-SaferPay.ps1][TCSGROUP\LD06974][INFO] Downloading -> TCS_avancepay_20230131_061628.csv
[20230201 09:50:04][Test-SaferPay.ps1][TCSGROUP\LD06974][INFO] Get-SFTPItem -SessionId 24 -path /advancePay/Success/TCS_avancepay_20230131_061628.csv -destination
PS>TerminatingError(Get-SFTPItem): "Cannot bind argument to parameter 'Destination' because it is an empty string."
[20230201 09:50:04][Test-SaferPay.ps1][TCSGROUP\LD06974][ERROR] Error while downloading : Cannot bind argument to parameter 'Destination' because it is an empty string. Item /advancePay/Success/TCS_avancepay_20230130_061952.csv already present on local host. Cannot find path 'Y:\99_TMP\Name TCS_avancepay_20230130_061952.csv, Length 7722, User ID 14, Group ID 50, Accessed 31.01.2023 10:44:19, Modified 30.01.2023 06:16:41.Name' because it does not exist. Item /advancePay/Success/TCS_avancepay_20230130_061952.csv already present on local host. Cannot find path 'Y:\99_TMP\Name TCS_avancepay_20230130_061952.csv, Length 7722, User ID 14, Group ID 50, Accessed 31.01.2023 10:44:19, Modified 30.01.2023 06:16:41.name' because it does not exist. Item /advancePay/Success/TCS_avancepay_20230130_061952.csv already present on local host. Cannot find path 'Y:\99_TMP\Name TCS_avancepay_20230130_061952.csv, Length 7722, User ID 14, Group ID 50, Accessed 31.01.2023 10:44:19, Modified 30.01.2023 06:16:41.name' because it does not exist. Item /advancePay/Success/TCS_avancepay_20230130_061952.csv already present on local host. Cannot find path 'Y:\03_DEV\06_GITHUB\tcs-1\Projects\IDIT_CheckSaferPay\TCS_avancepay_20230130_061952.csv' because it does not exist. Item /advancePay/Success/TCS_avancepay_20230130_061952.csv already present on local host. Exception calling "CompleteInput" with "4" argument(s): "Object reference not set to an instance of an object." Cannot find path 'Y:\03_DEV\06_GITHUB\tcs-1\sftp_avance_pay_prod.openssh.ppk' because it does not exist. Cannot validate argument on parameter 'ComputerName'. The argument is null or empty. Provide an argument that is not null or empty, and then try the command again. Exception calling ".ctor" with "2" argument(s): "Cannot process argument because the value of argument "userName" is not valid. Change the value of the "userName" argument and run the operation again." Exception calling ".ctor" with "2" argument(s): "Cannot process argument because the value of argument "userName" is not valid. Change the value of the "userName" argument and run the operation again." Cannot validate argument on parameter 'Credential'. The argument is null or empty. Provide an argument that is not null or empty, and then try the command again. Exception calling ".ctor" with "2" argument(s): "Cannot process argument because the value of argument "userName" is not valid. Change the value of the "userName" argument and run the operation again." Cannot validate argument on parameter 'Credential'. The argument is null or empty. Provide an argument that is not null or empty, and then try the command again. Exception calling ".ctor" with "2" argument(s): "Cannot process argument because the value of argument "userName" is not valid. Change the value of the "userName" argument and run the operation again." Cannot convert value "System.Object[]" to type "System.Xml.XmlDocument". Error: "The 'privKey' start tag on line 7 position 10 does not match the end tag of 'privkey'. Line 7, position 52." Cannot convert 'System.String' to the type 'System.Management.Automation.SwitchParameter' required by parameter 'SkipSymLink'.  Cannot convert 'System.String' to the type 'System.Management.Automation.SwitchParameter' required by parameter 'SkipSymLink'.  Cannot convert 'System.String' to the type 'System.Management.Automation.SwitchParameter' required by parameter 'SkipSymLink'.  /advancePay/Success/Name TCS_avancepay_20230130_061952.csv, Length 7722, User ID 14, Group ID 50, Accessed 30.01.2023 10:26:06, Modified 30.01.2023 06:16:41.Name does not exist. /advancePay/Success/Name TCS_avancepay_20230130_061952.csv, Length 7722, User ID 14, Group ID 50, Accessed 30.01.2023 10:26:06, Modified 30.01.2023 06:16:41.name does not exist. /advancePay/Success\Name TCS_avancepay_20230130_061952.csv, Length 7722, User ID 14, Group ID 50, Accessed 30.01.2023 10:26:06, Modified 30.01.2023 06:16:41.name does not exist. TCS_avancepay_20230130_061952.csv does not exist. The term 'Get-SFTPFile' is not recognized as a name of a cmdlet, function, script file, or executable program.
Check the spelling of the name, or if a path was included, verify that the path is correct and try again. The term 'Get-SFTPFile' is not recognized as a name of a cmdlet, function, script file, or executable program.
Check the spelling of the name, or if a path was included, verify that the path is correct and try again. The term 'Get-SFTPFile' is not recognized as a name of a cmdlet, function, script file, or executable program.
Check the spelling of the name, or if a path was included, verify that the path is correct and try again. Exception calling "CompleteInput" with "4" argument(s): "Value cannot be null. (Parameter 'expressions[26]')" Permission denied (publickey). Unable to find type [date]. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. A parameter cannot be found that matches parameter name 'ComputerNameNew-SFTPSession'. Exception calling "CompleteInput" with "4" argument(s): "Value cannot be null. (Parameter 'expressions[12]')" Method invocation failed because [System.String] does not contain a method named 'AddDays'. Path *.csv does not exist on the target host. A parameter cannot be found that matches parameter name 'file'. A parameter cannot be found that matches parameter name 'file'. A parameter cannot be found that matches parameter name 'file'. A parameter cannot be found that matches parameter name 'file'. A parameter cannot be found that matches parameter name 'File'. A parameter cannot be found that matches parameter name 'File'. Path *.csv does not exist on the target host. Path *.csv does not exist on the target host. Path *.csv does not exist on the target host. Cannot process argument transformation on parameter 'message'. Cannot convert value to type System.String. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Connection failed to establish within 10000 milliseconds. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Cannot bind argument to parameter 'SessionId' because it is null. Connection failed to establish within 10000 milliseconds.

Get-Content: Y:\03_DEV\06_GITHUB\tcs-1\Projects\IDIT_CheckSaferPay\Test-SaferPay.ps1:385:32
Line |
 385 |  … actions += (Get-Content ($conf.conf.pathes.local_path + "/" + $_.Name …
     |                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Cannot find path 'Y:\TCS_avancepay_20230131_061628.csv' because it does not exist.

Get-Content: Y:\03_DEV\06_GITHUB\tcs-1\Projects\IDIT_CheckSaferPay\Test-SaferPay.ps1:385:32
Line |
 385 |  … actions += (Get-Content ($conf.conf.pathes.local_path + "/" + $_.Name …
     |                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Cannot find path 'Y:\TCS_avancepay_20230131_061628.csv' because it does not exist.

[20230201 09:50:05][Test-SaferPay.ps1][TCSGROUP\LD06974][INFO] Transactions found in TCS_avancepay_20230131_061628.csv -> 0 transaction(s).

MethodException: Y:\03_DEV\06_GITHUB\tcs-1\Projects\IDIT_CheckSaferPay\Test-SaferPay.ps1:390:5
Line |
 390 |      $statStr = $selectdate + $SEP + $countTransactions + $SEP + $coun …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Cannot convert argument "1", with value: "", for "op_Addition" to type "System.TimeSpan": "Cannot convert null to type "System.TimeSpan"."

MethodException: Y:\03_DEV\06_GITHUB\tcs-1\Projects\IDIT_CheckSaferPay\Test-SaferPay.ps1:390:5
Line |
 390 |      $statStr = $selectdate + $SEP + $countTransactions + $SEP + $coun …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Cannot convert argument "1", with value: "", for "op_Addition" to type "System.TimeSpan": "Cannot convert null to type "System.TimeSpan"."

PS>TerminatingError(Set-Content): "Cannot bind argument to parameter 'Path' because it is an empty string."

Set-Content: Y:\03_DEV\06_GITHUB\tcs-1\Projects\IDIT_CheckSaferPay\Test-SaferPay.ps1:392:27
Line |
 392 |          Set-Content -path $conf.conf.pathes.csv_path -value $statStr
     |                            ~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Cannot bind argument to parameter 'Path' because it is an empty string.

Set-Content: Y:\03_DEV\06_GITHUB\tcs-1\Projects\IDIT_CheckSaferPay\Test-SaferPay.ps1:392:27
Line |
 392 |          Set-Content -path $conf.conf.pathes.csv_path -value $statStr
     |                            ~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Cannot bind argument to parameter 'Path' because it is an empty string.

[20230201 09:50:06][Test-SaferPay.ps1][TCSGROUP\LD06974][INFO] Close connection to SFTP
[20230201 09:50:06][Test-SaferPay.ps1][TCSGROUP\LD06974][INFO] ------------------------------------------------------------------------------------------------------------------------------------
[20230201 09:50:06][Test-SaferPay.ps1][TCSGROUP\LD06974][INFO] ------------------------------------------------------------------------------------------------------------------------------------
**********************
PowerShell transcript end
End time: 20230201095006
**********************
